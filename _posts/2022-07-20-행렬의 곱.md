---
published : true 
title : 행렬의 곱  
layout : single 
toc : true 
katex : True 
---
# 행렬의 곱

행렬끼리를 곱하는 방법을 배웁니다. 벡터끼리의 내적을 행렬로 확장하면 행렬의 곱이 됩니다.

행렬의 곱은 인공지능에서 효율적인 계산을 시행하기 위해서 중요한 조작입니다.

## 행렬의 곱

일반적으로 "행렬의 곱"인 경우 아래와 같이 조금 복잡한 연산을 가르킵니다.

![](https://algebra1course.files.wordpress.com/2013/02/slide10.jpg)

행렬곱에서는 앞 행렬에서의 행의 각 요소와 뒤 행렬에서의 열의 각요소를 곱해서 총합을 구하고, 새로운 행렬의 요소로 합니다. 

이와 같이 해서 왼쪽 행렬의 전체 행과 오른쪽 행렬의 전체 열을 합쳐서 연산을 실시, 새로운 행렬을 만듭니다.

그럼 행렬곱의 예를 살펴봅시다. 먼저 행렬 A와 B를 다음과 같이 설정합니다.

$$
A = \begin{pmatrix}a_{11} & a_{12} & a_{13}\\
a_{21} & a_{22} & a_{23}
\end{pmatrix}
$$

$$
B = \begin{pmatrix}b_{11} & b_{12}\\
b_{21} & b_{22}\\
c_{31} & c_{32} 
\end{pmatrix}
$$

A는 2*3의 행렬, B는 3*2의 행렬입니다. 그리고 A와 B의 곱을 다음과 같이 나타냅니다.

$$
AB = \begin{pmatrix}a_{11} & a_{12} & a_{13}\\
a_{21} & a_{22} & a_{23}
\end{pmatrix} \begin{pmatrix}b_{11} & b_{12}\\
b_{21} & b_{22}\\
c_{31} & c_{32} 
\end{pmatrix}
$$

$$
= \begin{pmatrix}a_{11}b_{11} +a_{12}b_{12}+a_{13}b_{13} & a_{11}b_{12}+a_{12}b_{22}+a_{12}b_{13}\\
a_{21}b_{11} + a_{22}b_{21} + a_{23}b_{31}  & a_{21}b_{12} + a_{22}b_{22} + a_{23}b_{32}     
\end{pmatrix}
$$

$$
= \begin{pmatrix}\sum_{k=1}^3{a_{1k}b_{k1}} & \sum_{k=1}^{3}{a_{1k}b_{k2}} \\
\sum_{k=1}^{3}{a_{2k}b_{k1}} & \sum_{k=1}^{3}{a_{2k}b_{k2}}
\end{pmatrix}
$$

A의 각 행과 B행의 각 요소를 곱해서 총합을 취하고, 새로운 행렬의 각 요소로 합니다.

위의 행렬곱에는 총합의 기호 $$\sum{}$$가 등장하는데 행렬곱은 곱의 총합을 계산할 떄 대활약합니다. 

인공지능에서는 곱의 총합을 자주 계산하므로 챙렬곱은 뺴놓을 수 없습니다.

## 행렬곱의 수치 계산

그럼 시험삼아 수치 계산을 해 봅시다. 다음의 행렬 A,B를 봅시다.

$$
A = \begin{pmatrix}
0 & 1 & 2 \\
1 & 2 & 3
\end{pmatrix}
$$

$$
B = \begin{pmatrix}
2 & 1 \\
2 & 1 \\
2 & 1
\end{pmatrix}
$$

이러한 행렬의 행렬곱은 다음과 같이 계산할 수 있습니다.

$$
AB =\begin{pmatrix}
0 & 1 & 2 \\
1 & 2 & 3
\end{pmatrix}
\begin{pmatrix}
2 & 1 \\
2 & 1 \\
2 & 1
\end{pmatrix}
$$

$$
= \begin{pmatrix} 0 * 2 + 1 * 2 + 2 *2 & 0 * 1 + 1 * 1 + 2 * 1 \\ 1 * 2 + 2 * 2 + 3 * 2 & 1 * 1 + 1 + 2 * 1 +3 * 1 \end{pmatrix}
$$

$$
= \begin{pmatrix} 6 & 3 \\ 12 & 6\end{pmatrix}
$$

스칼라의 곱과 달리 행렬곱에서는 앞 행렬과 뒤 행렬의 교환은 특정 조건을 만족하고 있는 경우를 제외할 수 없습니다.

그리고 행렬곱을 계산하려면 앞의 행렬의 열수와 뒤 행렬의 행수가 일치해야합니다.

예를 들어, 앞 행렬의 열수가 3이면 뒤 행렬의 행수는 3이어야 합니다.

## 행렬곱의 일반화

행렬곱을 더욱 일반적인 형태로 기술합니다. 다음인 l * m의 행렬의 행렬 A 와  m * n의 행렬 B의 행렬곱입니다.

$$
AB = 
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1m} \\ 
a_{21} & a_{22} & \cdots & a_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
a_{l1} & a_{l2} & \cdots & a_{lm} 
\end{pmatrix} \begin {pmatrix}
b_{11} & b_{12} & \cdots & b_{1m} \\ 
b_{21} & b_{22} & \cdots & b_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
b_{l1} & b_{l2} & \cdots & b_{lm} 
\end {pmatrix} 
$$


$$
=\begin{pmatrix}
\sum_{k=1}^m{a_{1k}b_{k1}} & \sum_{k=1}^m{a_{1k}b_{k2}} & \cdots & \sum_{k=1}^m{a_{1k}b_{kn}} \\
\sum_{k=1}^m{a_{2k}b_{k1}} & \sum_{k=1}^m{a_{2k}b_{k2}} & \cdots & \sum_{k=1}^m{a_{2k}b_{kn}} \\ 
\vdots & \vdots & \ddots & \vdots \\
\sum_{k=1}^m{a_{lk}b_{k1}} & \sum_{k=1}^m{a_{lk}b_{k2}} & \cdots & \sum_{k=1}^m{a_{lk}b_{kn}}
\end {pmatrix}
$$

## 행렬곱의 구현

행렬곱을 전체 행과 열의 조합으로 계산하는 건 힘드지만 numpy의 **dot()** 함수를 이용하면 간단하게 행렬곱을 계산할 수 있습니다.


```python
import numpy as np

a = np.array([[0,1,2],[1,2,3]])

b = np.array=([[2,1],
              [2,1],
              [2,1]])

print(np.dot(a,b))
```

    [[ 6  3]
     [12  6]]


## 요소별 곱(아다마르 곱)

행렬의 요소별 곱은 아다마르 곱이라고도 불르며, 행렬의 각 요소를 곱합니다.
다음의 행렬 A,B를 봅시다.

$$
A = \begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1m} \\ 
a_{21} & a_{22} & \cdots & a_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
a_{l1} & a_{l2} & \cdots & a_{lm} 
\end{pmatrix} 
$$

$$
B = \begin {pmatrix}
b_{11} & b_{12} & \cdots & b_{1m} \\ 
b_{21} & b_{22} & \cdots & b_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
b_{l1} & b_{l2} & \cdots & b_{lm} 
\end {pmatrix}
$$

이러한 행렬의 요소별 곱은 연산자 $$\circ$$ 를 이용해서 다음과 같이 나타낼 수 있습니다.

$$
A \circ B  =  \begin {pmatrix} a_{11}b_{12}& a_{12}b_{12}& \cdots& a_{1n}b_{1n} \\ 
a_{21}b_{21} & a_{22}b_{22} & \cdots & a_{2n}b_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{m1}b_{m2} & a_{m2}b_{m2}&  \cdots  & a_{mn}b_{mn}
\end{pmatrix}
$$

예를 들어 다음과 같은 경우

$$
A = \begin{pmatrix} 0 & 1 & 2 \\
3 & 4 & 5 \\
6 & 7 & 8
\end {pmatrix}
$$

$$
B = \begin{pmatrix} 0 & 1 & 2 \\
2 & 0 & 1 \\
1 & 2 & 0 
\end {pmatrix}
$$

A와 B의 요소별 곱은 다음과 같습니다. 

$$
A \circ B = \begin{pmatrix} 0 * 0 & 1 * 1 & 2 * 2 \\
3 *2  & 4 * 0 & 5 * 1 \\
6 * 1 & 7 * 2 & 8 * 0 
\end{pmatrix} 
$$

$$
=\begin{pmatrix} 0 & 1 & 4 \\
6 & 0 & 5 \\
6 & 14 & 0
\end{pmatrix}
$$

이상과 같이 요소별 곱은 행렬곱과 비교해 간단합니다.

## 요소별 곱의 구현

요소별 곱은 아래처럼 numpy를 이용해서 구할 수 있습니다.
요소별 욘산에는 스칼라 곱의 연산자 *를 사용합니다.



```python
import numpy as np

a = np.array([[0,1,2],[3,4,5],[6,7,8]])
b = np.array([[0,1,2],[2,0,1],[1,2,0]])

print(a*b)
```


    ---------------------------------------------------------------------------

    TypeError                                 Traceback (most recent call last)

    Input In [22], in <cell line: 3>()
          1 import numpy as np
    ----> 3 a = np.array([[0,1,2],[3,4,5],[6,7,8]])
          4 b = np.array([[0,1,2],[2,0,1],[1,2,0]])
          6 print(a*b)


    TypeError: 'list' object is not callable

